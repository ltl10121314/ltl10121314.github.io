<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Redisé«˜çº§ | äº‘èµ·è¿é£ç‡•</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Redisé«˜çº§</h1><a id="logo" href="/.">äº‘èµ·è¿é£ç‡•</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Redisé«˜çº§</h1><div class="post-meta">2020-04-05<span> | </span><span class="category"><a href="/categories/Redis/">Redis</a></span></div><div class="post-content"><h1 id="10-ä¸»ä»å¤åˆ¶"><a href="#10-ä¸»ä»å¤åˆ¶" class="headerlink" title="10.ä¸»ä»å¤åˆ¶"></a>10.ä¸»ä»å¤åˆ¶</h1><img src="http://ww2.sinaimg.cn/large/006tNc79gy1g4usk8ab4hj30k10egq58.jpg" width=520 />

<p><strong>ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶</strong></p>
<p>æŒä¹…åŒ–ä¿è¯äº†å³ä½¿redis æœåŠ¡é‡å¯ä¹Ÿä¼šä¸¢å¤±æ•°æ®ï¼Œå› ä¸º redis æœåŠ¡é‡å¯åä¼šå°†ç¡¬ç›˜ä¸ŠæŒä¹…åŒ–çš„æ•°æ®æ¢å¤åˆ°å†…å­˜ä¸­ï¼Œä½†æ˜¯å½“ redisæœåŠ¡å™¨çš„ç¡¬ç›˜æŸåäº†å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œå¦‚æœé€šè¿‡ redis çš„ä¸»ä»å¤åˆ¶æœºåˆ¶å°±å¯ä»¥é¿å…è¿™ç§å•ç‚¹æ•…éšœ</p>
<p><strong>ä¸»ä»å¤åˆ¶çš„ä½œç”¨</strong></p>
<ul>
<li>æ•°æ®å‰¯æœ¬</li>
<li>æ‰©å±•è¯»æ€§èƒ½</li>
</ul>
<p><strong>ä¸»ä»é…ç½®æ³¨æ„äº‹é¡¹</strong></p>
<ul>
<li>ä¸€ä¸ªmasterå¯ä»¥æœ‰å¤šä¸ªslave</li>
<li>ä¸€ä¸ªslaveåªèƒ½æœ‰ä¸€ä¸ªmaster</li>
<li>æ•°æ®æµæ˜¯å•å‘çš„ï¼Œmasteråˆ°slave</li>
</ul>
<h2 id="10-1-ä¸»ä»å¤åˆ¶é…ç½®"><a href="#10-1-ä¸»ä»å¤åˆ¶é…ç½®" class="headerlink" title="10.1 ä¸»ä»å¤åˆ¶é…ç½®"></a>10.1 ä¸»ä»å¤åˆ¶é…ç½®</h2><p>ä¸»ä»é…ç½®æœ‰ä¸¤ç§å®ç°æ–¹å¼</p>
<ul>
<li>slaveofå‘½ä»¤</li>
<li>æ–‡ä»¶é…ç½®</li>
</ul>
<p><font color=red>æ³¨:info replicationæŸ¥çœ‹ä¸»ä»åˆ†ç‰‡ä¿¡æ¯</font></p>
<p><strong>slaveofå‘½ä»¤</strong></p>
<img src="http://ww2.sinaimg.cn/large/006tNc79gy1g4up70dzktj30l604cq3b.jpg" width=600 />

<p><strong>å–æ¶ˆå¤åˆ¶</strong></p>
<img src="http://ww2.sinaimg.cn/large/006tNc79gy1g4up77csiyj30ks04pjrq.jpg" width=600 />

<p><strong>æ–‡ä»¶é…ç½®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">################################# REPLICATION #################################</span><br><span class="line"></span><br><span class="line"># Master-Slave replication. Use slaveof to make a Redis instance a copy of</span><br><span class="line"># another Redis server. A few things to understand ASAP about Redis replication.</span><br><span class="line">#</span><br><span class="line"># 1) Redis replication is asynchronous, but you can configure a master to</span><br><span class="line">#    stop accepting writes if it appears to be not connected with at least</span><br><span class="line">#    a given number of slaves.</span><br><span class="line"># 2) Redis slaves are able to perform a partial resynchronization with the</span><br><span class="line">#    master if the replication link is lost for a relatively small amount of</span><br><span class="line">#    time. You may want to configure the replication backlog size (see the next</span><br><span class="line">#    sections of this file) with a sensible value depending on your needs.</span><br><span class="line"># 3) Replication is automatic and does not need user intervention. After a</span><br><span class="line">#    network partition slaves automatically try to reconnect to masters</span><br><span class="line">#    and resynchronize with them.</span><br><span class="line">#</span><br><span class="line"># slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br><span class="line"># Since Redis 2.6 by default slaves are read-only.</span><br><span class="line">#</span><br><span class="line"># Note: read only slaves are not designed to be exposed to untrusted clients</span><br><span class="line"># on the internet. It&#x27;s just a protection layer against misuse of the instance.</span><br><span class="line"># Still a read only slave exports by default all the administrative commands</span><br><span class="line"># such as CONFIG, DEBUG, and so forth. To a limited extent you can improve</span><br><span class="line"># security of read only slaves using &#x27;rename-command&#x27; to shadow all the</span><br><span class="line"># administrative / dangerous commands.</span><br><span class="line">slave-read-only yes</span><br></pre></td></tr></table></figure>

<p><strong>slaveofå‘½ä»¤ vs æ–‡ä»¶é…ç½®</strong></p>
<table>
<thead>
<tr>
<th>æ–¹å¼</th>
<th>å‘½ä»¤</th>
<th>é…ç½®</th>
</tr>
</thead>
<tbody><tr>
<td>ä¼˜ç‚¹</td>
<td>æ— éœ€é‡å¯</td>
<td>ç»Ÿä¸€é…ç½®</td>
</tr>
<tr>
<td>ç¼ºç‚¹</td>
<td>ä¸ä¾¿äºç®¡ç†</td>
<td>éœ€è¦é‡å¯</td>
</tr>
</tbody></table>
<h2 id="10-2-å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶"><a href="#10-2-å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶" class="headerlink" title="10.2 å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶"></a>10.2 å…¨é‡å¤åˆ¶ä¸å¢é‡å¤åˆ¶</h2><p><strong>How Redis replication works</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Every Redis master has a replication ID: it is a large pseudo random string that marks a given story of the dataset. Each master also takes an offset that increments for every byte of replication stream that it is produced to be sent to slaves, in order to update the state of the slaves with the new changes modifying the dataset. The replication offset is incremented even if no slave is actually connected, so basically every given pair of:</span><br><span class="line">Replication ID, offset</span><br><span class="line">Identifies an exact version of the dataset of a master.</span><br><span class="line">When slaves connects to masters, they use the PSYNC command in order to send their old master replication ID and the offsets they processed so far. This way the master can send just the incremental part needed. However if there is not enough backlog in the master buffers, or if the slave is referring to an history (replication ID) which is no longer known, than a full resynchronization happens: in this case the slave will get a full copy of the dataset, from scratch.</span><br></pre></td></tr></table></figure>

<p>ç¿»è¯‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ¯ä¸€ä¸ªRedis masteréƒ½æœ‰ä¸€ä¸ª replication ID ï¼šè¿™æ˜¯ä¸€ä¸ªè¾ƒå¤§çš„ä¼ªéšæœºå­—ç¬¦ä¸²ï¼Œæ ‡è®°äº†ä¸€ä¸ªç»™å®šçš„æ•°æ®é›†ã€‚æ¯ä¸ª masterä¹ŸæŒæœ‰ä¸€ä¸ªåç§»é‡ï¼Œmasterå°†è‡ªå·±äº§ç”Ÿçš„å¤åˆ¶æµå‘é€ç»™slaveæ—¶ï¼Œå‘é€å¤šå°‘ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œè‡ªèº«çš„åç§»é‡å°±ä¼šå¢åŠ å¤šå°‘ï¼Œç›®çš„æ˜¯å½“æœ‰æ–°çš„æ“ä½œä¿®æ”¹è‡ªå·±çš„æ•°æ®é›†æ—¶ï¼Œå®ƒå¯ä»¥ä»¥æ­¤æ›´æ–°slaveçš„çŠ¶æ€ã€‚å¤åˆ¶åç§»é‡å³ä½¿åœ¨æ²¡æœ‰ä¸€ä¸ªslaveè¿æ¥åˆ°masteræ—¶ï¼Œä¹Ÿä¼šè‡ªå¢ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæ¯ä¸€å¯¹ç»™å®šçš„</span><br><span class="line">Replication ID, offset</span><br><span class="line">éƒ½ä¼šæ ‡è¯†ä¸€ä¸ªmasteræ•°æ®é›†çš„ç¡®åˆ‡ç‰ˆæœ¬</span><br><span class="line">å½“slaveè¿æ¥åˆ°masteræ—¶ï¼Œå®ƒä»¬ä½¿ç”¨PSYNCå‘½ä»¤æ¥å‘é€å®ƒä»¬è®°å½•çš„æ—§çš„master replication IDå’Œå®ƒä»¬è‡³ä»Šä¸ºæ­¢å¤„ç†çš„åç§»é‡ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ masterèƒ½å¤Ÿä»…å‘é€slaveæ‰€éœ€çš„å¢é‡éƒ¨åˆ†ã€‚ä½†æ˜¯å¦‚æœmasterçš„ç¼“å†²åŒºä¸­æ²¡æœ‰è¶³å¤Ÿçš„å‘½ä»¤ç§¯å‹ç¼“å†²è®°å½•ï¼Œæˆ–è€…å¦‚æœslaveå¼•ç”¨äº†ä¸å†çŸ¥é“çš„å†å²è®°å½•ï¼ˆreplication IDï¼‰ï¼Œåˆ™ä¼šè½¬è€Œè¿›è¡Œä¸€ä¸ªå…¨é‡é‡åŒæ­¥ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œslaveä¼šå¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„æ•°æ®é›†å‰¯æœ¬ï¼Œä»å¤´å¼€å§‹</span><br></pre></td></tr></table></figure>

<p><strong>å…¨é‡å¤åˆ¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The master starts a background saving process in order to produce an RDB file. At the same time it starts to buffer all new write commands received from the clients. When the background saving is complete, the master transfers the database file to the slave, which saves it on disk, and then loads it into memory. The master will then send all buffered commands to the slave.</span><br></pre></td></tr></table></figure>

<p>ç¿»è¯‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masterå¼€å¯ä¸€ä¸ªåå°ä¿å­˜è¿›ç¨‹ï¼Œä»¥ä¾¿äºç”Ÿäº§ä¸€ä¸ªRDBæ–‡ä»¶ã€‚åŒæ—¶å®ƒå¼€å§‹ç¼“å†²æ‰€æœ‰ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„æ–°çš„å†™å…¥å‘½ä»¤ã€‚å½“åå°ä¿å­˜å®Œæˆæ—¶ï¼Œ masterå°†æ•°æ®é›†æ–‡ä»¶ä¼ è¾“ç»™slaveï¼Œ slaveå°†ä¹‹ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œç„¶ååŠ è½½æ–‡ä»¶åˆ°å†…å­˜ã€‚å†ç„¶åmaster ä¼šå‘é€æ‰€æœ‰ç¼“å†²çš„å‘½ä»¤å‘ç»™slave</span><br></pre></td></tr></table></figure>

<p><strong>å…¨é‡å¤åˆ¶çš„å¼€é”€</strong></p>
<ul>
<li>bgsaveæ—¶é—´</li>
<li>RDBæ–‡ä»¶ç½‘ç»œä¼ è¾“æ—¶é—´</li>
<li>ä»èŠ‚ç‚¹æ¸…ç©ºæ•°æ®æ—¶é—´</li>
<li>ä»èŠ‚ç‚¹åŠ è½½æ•°æ®æ—¶é—´</li>
<li>å¯èƒ½çš„AOFé‡å†™æ—¶é—´</li>
</ul>
<p><strong><font color=red>å¦‚ä½•é¿å…å…¨é‡å¤åˆ¶</font></strong></p>
<ul>
<li>masterèŠ‚ç‚¹é¿å…å…³é—­æŒä¹…åŒ–åŠŸèƒ½</li>
<li>redis sentinel</li>
</ul>
<h1 id="11-redis-sentinel"><a href="#11-redis-sentinel" class="headerlink" title="11.redis sentinel"></a>11.redis sentinel</h1><img src="http://ww4.sinaimg.cn/large/006tNc79gy1g4uslkb7juj30nz0k3760.jpg" width=550 />

<p><strong>redis sentinel</strong>(å“¨å…µæ¨¡å¼)ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ã€‚ç”¨äºç›‘æ§redisé›†ç¾¤ä¸­Masterä¸»æœåŠ¡å™¨å·¥ä½œçš„çŠ¶æ€ï¼Œåœ¨Masterä¸»æœåŠ¡å™¨å‘ç”Ÿæ•…éšœçš„æ—¶å€™ï¼Œå¯ä»¥å®ç°Masterå’ŒSlaveæœåŠ¡å™¨çš„åˆ‡æ¢ï¼Œä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨</p>
<p><font color=red>å½“ä¸€ä¸ªå®ä¾‹åœ¨æ•…éšœè½¬ç§»åè¢«æå‡ä¸º master æ—¶ï¼Œå®ƒä»ç„¶èƒ½å¤Ÿä¸æ—§ master çš„ slaves è¿›è¡Œéƒ¨åˆ†é‡åŒæ­¥</font></p>
<p><strong>redis sentinelæ•…éšœè½¬ç§»</strong></p>
<ol>
<li>å¤šä¸ªsentinelå‘ç°å¹¶ç¡®è®¤masterå‡ºç°æ•…éšœ</li>
<li>é€‰ä¸¾å‡ºä¸€ä¸ªsentinelæ‰§è¡Œfailoveræ“ä½œ</li>
<li>é€‰å‡ºä¸€ä¸ªslaveä½œä¸ºmaster</li>
<li>é€šçŸ¥å…¶ä½™çš„slaveæˆä¸ºæ–°masterçš„slave</li>
<li>é€šè¿‡å®¢æˆ·ç«¯ä¸»ä»å˜åŒ–</li>
<li>ç­‰å¾…è€çš„masterå¤æ´»æˆä¸ºæ–°çš„masterçš„slave</li>
</ol>
<h2 id="11-1-redis-sentinelå®‰è£…é…ç½®"><a href="#11-1-redis-sentinelå®‰è£…é…ç½®" class="headerlink" title="11.1 redis sentinelå®‰è£…é…ç½®"></a>11.1 redis sentinelå®‰è£…é…ç½®</h2><ol>
<li>é…ç½®ä¸»ä»èŠ‚ç‚¹</li>
<li>é…ç½®å¼€å¯sentinelç›‘æ§ä¸»èŠ‚ç‚¹</li>
</ol>
<table>
<thead>
<tr>
<th>èŠ‚ç‚¹</th>
<th>ä¸»æœº</th>
<th>ç«¯å£</th>
</tr>
</thead>
<tbody><tr>
<td>redis-master</td>
<td>192.168.0.100</td>
<td>7000</td>
</tr>
<tr>
<td>redis-slave1</td>
<td>192.168.0.101</td>
<td>7001</td>
</tr>
<tr>
<td>redis-slave2</td>
<td>192.168.0.102</td>
<td>7002</td>
</tr>
<tr>
<td>redis-sentinel1</td>
<td>192.168.0.100</td>
<td>26379</td>
</tr>
<tr>
<td>redis-sentinel2</td>
<td>192.168.0.101</td>
<td>26380</td>
</tr>
<tr>
<td>redis-sentinel3</td>
<td>192.168.0.102</td>
<td>26381</td>
</tr>
</tbody></table>
<p><strong>redis-7000.conf</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">port 7000</span><br><span class="line">daemonize yes</span><br><span class="line">pidfile /var/run/redis-7000.pid</span><br><span class="line">logfile &quot;redis-7000.log&quot;</span><br><span class="line">dir /opt/modules/redis-4.0.14/data</span><br></pre></td></tr></table></figure>

<p><strong>redis-sentinel.conf</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">port 26379</span><br><span class="line">daemonize yes</span><br><span class="line">bind 192.168.0.100 127.0.0.1</span><br><span class="line">dir &quot;/opt/modules/redis-4.0.14/data&quot;</span><br><span class="line">logfile &quot;redis-sentinel.log&quot;</span><br><span class="line">sentinel monitor mymaster 192.169.0.100 6379 2</span><br><span class="line">sentinel down-after-milliseconds mymaster 30000</span><br><span class="line">sentinel failover-timeout mymaster 180000</span><br></pre></td></tr></table></figure>

<p><strong>è®¿é—®sentinel</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 192.168.0.100 -p 26379</span><br></pre></td></tr></table></figure>

<h2 id="11-2-javaå®¢æˆ·ç«¯"><a href="#11-2-javaå®¢æˆ·ç«¯" class="headerlink" title="11.2 javaå®¢æˆ·ç«¯"></a><strong>11.2 javaå®¢æˆ·ç«¯</strong></h2><p>æ·»åŠ ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">type</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.26<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»£ç æ¼”ç¤ºè¯´æ˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisSentinelTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Logger logger = LoggerFactory.getLogger(JedisSentinelTest.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String masterName = <span class="string">&quot;mymaster&quot;</span>;</span><br><span class="line">        Set&lt;String&gt; sentinels = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">        sentinels.add(<span class="string">&quot;192.168.0.110:26379&quot;</span>);</span><br><span class="line">        sentinels.add(<span class="string">&quot;192.168.0.105:26380&quot;</span>);</span><br><span class="line">        sentinels.add(<span class="string">&quot;192.168.0.108:26381&quot;</span>);</span><br><span class="line"></span><br><span class="line">        JedisSentinelPool sentinelPool = <span class="keyword">new</span> JedisSentinelPool(masterName, sentinels);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            Jedis jedis = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                jedis = sentinelPool.getResource();</span><br><span class="line">                String key = <span class="string">&quot;k-&quot;</span> + index;</span><br><span class="line">                String value = <span class="string">&quot;v-&quot;</span> + index;</span><br><span class="line">                <span class="comment">//set key</span></span><br><span class="line">                jedis.set(key, value);</span><br><span class="line">                logger.info(<span class="string">&quot;key: &quot;</span> + key + <span class="string">&quot; value: &quot;</span> + value);</span><br><span class="line">                index++;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                logger.error(e.getMessage());</span><br><span class="line">            &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(jedis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    jedis.close();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="12-redis-cluster"><a href="#12-redis-cluster" class="headerlink" title="12.redis cluster"></a>12.redis cluster</h1><p>æ€ä¹ˆæ‰èƒ½å¤Ÿçªç ´å•æœºç“¶é¢ˆï¼Œè®©redisæ”¯æ’‘æµ·é‡æ•°æ®</p>
<p>æ”¯æ’‘Nä¸ªredis master nodeï¼Œæ¯ä¸ªmaster nodeéƒ½å¯ä»¥æŒ‚è½½å¤šä¸ªslave node</p>
<p>å¤šmaster + è¯»å†™åˆ†ç¦» + é«˜å¯ç”¨</p>
<p>å¯¹æ¯”replication+sentinel</p>
<p>replication+sentinal:æ•°æ®é‡å¾ˆå°‘ï¼Œä¸»è¦æ‰¿è½½é«˜å¹¶å‘åœºæ™¯ï¼Œæé«˜ååé‡ï¼Œä¿è¯redisçš„é«˜å¯ç”¨æ€§</p>
<p>reids cluster:æµ·é‡æ•°æ®+é«˜å¹¶å‘+é«˜å¯ç”¨</p>
<h1 id="13-ç¼“å­˜è®¾è®¡ä¸ä¼˜åŒ–"><a href="#13-ç¼“å­˜è®¾è®¡ä¸ä¼˜åŒ–" class="headerlink" title="13.ç¼“å­˜è®¾è®¡ä¸ä¼˜åŒ–"></a>13.ç¼“å­˜è®¾è®¡ä¸ä¼˜åŒ–</h1><h2 id="13-1-ç¼“å­˜çš„å—ç›Šä¸æˆæœ¬"><a href="#13-1-ç¼“å­˜çš„å—ç›Šä¸æˆæœ¬" class="headerlink" title="13.1 ç¼“å­˜çš„å—ç›Šä¸æˆæœ¬"></a>13.1 ç¼“å­˜çš„å—ç›Šä¸æˆæœ¬</h2><ul>
<li>å—ç›Š<ol>
<li>åŠ é€Ÿè¯»å†™</li>
<li>å‡ä½åç«¯è´Ÿè½½</li>
</ol>
</li>
<li>æˆæœ¬<ol>
<li>æ•°æ®ä¸ä¸€è‡´</li>
<li>å¢åŠ ç¼“å­˜é€»è¾‘ç»´æŠ¤</li>
</ol>
</li>
<li>ä½¿ç”¨åœºæ™¯<ul>
<li>ç¼“å­˜é«˜æ¶ˆè€—SQLï¼šjoinç»“æœé›†ã€åˆ†ç»„ç»Ÿè®¡ç­‰</li>
<li>åŠ é€Ÿè¯·æ±‚å“åº”ï¼šä¼˜åŒ–I/Oå“åº”æ—¶é—´</li>
<li>è®¡æ•°å™¨ä¼˜åŒ–ï¼šredisç´¯åŠ ï¼Œå†åŒæ­¥åˆ°DB</li>
</ul>
</li>
</ul>
<h2 id="13-2-ç¼“å­˜æ›´æ–°ç­–ç•¥"><a href="#13-2-ç¼“å­˜æ›´æ–°ç­–ç•¥" class="headerlink" title="13.2 ç¼“å­˜æ›´æ–°ç­–ç•¥"></a>13.2 ç¼“å­˜æ›´æ–°ç­–ç•¥</h2><ol>
<li>LRU/LFU/FIFOç®—æ³•å‰”é™¤</li>
<li>è¶…æ—¶å‰”é™¤</li>
<li>ä¸»åŠ¨æ›´æ–°</li>
</ol>
<table>
<thead>
<tr>
<th>ç­–ç•¥</th>
<th>ä¸€è‡´æ€§</th>
<th>ç»´æŠ¤æˆæœ¬</th>
</tr>
</thead>
<tbody><tr>
<td>LRU/LFU/FIFOç®—æ³•</td>
<td>æœ€å·®</td>
<td>åº•</td>
</tr>
<tr>
<td>è¶…æ—¶å‰”é™¤</td>
<td>è¾ƒå·®</td>
<td>åº•</td>
</tr>
<tr>
<td>ä¸»åŠ¨æ›´æ–°</td>
<td>å¼º</td>
<td>é«˜</td>
</tr>
</tbody></table>
<p><strong>å»ºè®®</strong></p>
<ul>
<li>å¯¹äºä½ä¸€è‡´æ€§æ•°æ®ï¼Œä½¿ç”¨LRU/LFU/FIFOç®—æ³•å’Œè¶…æ—¶å‰”é™¤</li>
<li>å¯¹äºé«˜ä¸€è‡´æ€§æ•°æ®ï¼Œä½¿ç”¨ä¸»åŠ¨æ›´æ–°ï¼ŒLRU/LFU/FIFOç®—æ³•å’Œè¶…æ—¶å…œåº•</li>
</ul>
<h2 id="13-3-ç¼“å­˜ç²’åº¦æ§åˆ¶"><a href="#13-3-ç¼“å­˜ç²’åº¦æ§åˆ¶" class="headerlink" title="13.3 ç¼“å­˜ç²’åº¦æ§åˆ¶"></a>13.3 ç¼“å­˜ç²’åº¦æ§åˆ¶</h2><ul>
<li>é€šç”¨æ€§ï¼šå…¨é‡å±æ€§æœ€å¥½</li>
<li>å ç”¨ç©ºé—´ï¼šéƒ¨åˆ†å±æ€§æœ€å¥½</li>
<li>ç»´æŠ¤æˆæœ¬ï¼šè¡¨é¢ä¸Šå…¨é‡å±æ€§æ›´å¥½</li>
</ul>
<h2 id="13-4-ç¼“å­˜ç©¿é€"><a href="#13-4-ç¼“å­˜ç©¿é€" class="headerlink" title="13.4 ç¼“å­˜ç©¿é€"></a>13.4 ç¼“å­˜ç©¿é€</h2><p>ç¼“å­˜ç©¿é€ï¼Œæ˜¯æŒ‡æŸ¥è¯¢ä¸€ä¸ªæ•°æ®åº“ä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ã€‚æ­£å¸¸çš„ä½¿ç”¨ç¼“å­˜æµç¨‹å¤§è‡´æ˜¯ï¼Œæ•°æ®æŸ¥è¯¢å…ˆè¿›è¡Œç¼“å­˜æŸ¥è¯¢ï¼Œå¦‚æœkeyä¸å­˜åœ¨æˆ–è€…keyå·²ç»è¿‡æœŸï¼Œå†å¯¹æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶æŠŠæŸ¥è¯¢åˆ°çš„å¯¹è±¡ï¼Œæ”¾è¿›ç¼“å­˜ã€‚å¦‚æœæ•°æ®åº“æŸ¥è¯¢å¯¹è±¡ä¸ºç©ºï¼Œåˆ™ä¸æ”¾è¿›ç¼“å­˜</p>
<img src="http://ww4.sinaimg.cn/large/006tNc79gy1g4vpsexeipj30h60gkaah.jpg" width=350 align=left />

<p><strong>äº§ç”ŸåŸå› </strong></p>
<ul>
<li>ä¸šåŠ¡ä»£ç é€»è¾‘é—®é¢˜</li>
<li>çˆ¬è™«æˆ–æ¶æ„æ”»å‡»</li>
</ul>
<p><strong>å¦‚ä½•å‘ç°</strong></p>
<ul>
<li>ä¸šåŠ¡æ‰§è¡Œæ—¶é—´</li>
<li>ç›¸å…³æŒ‡æ ‡ï¼šç¼“å­˜å‘½ä¸­æ•°ã€å­˜å‚¨å±‚å‘½ä¸­æ•°</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<ol>
<li>ç¼“å­˜ç©ºå¯¹è±¡</li>
</ol>
<h2 id="13-4-ç¼“å­˜å‡»ç©¿"><a href="#13-4-ç¼“å­˜å‡»ç©¿" class="headerlink" title="13.4 ç¼“å­˜å‡»ç©¿"></a>13.4 ç¼“å­˜å‡»ç©¿</h2><p>ç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<ol>
<li><p>äº’æ–¥é”</p>
<p>é¦–ä¸ªå‘ç°ç¼“å­˜è¿‡æœŸçš„çº¿ç¨‹ï¼Œå¯¹å½“å‰keyè·å–è¿›è¡ŒåŠ é”ï¼Œåœ¨åŒæ­¥æ•°æ®åˆ°redisä¸­åï¼Œé‡Šæ”¾é”</p>
</li>
<li><p>æ°¸ä¸è¿‡æœŸ</p>
<p>ä¸ºkeyæ·»åŠ é€»è¾‘è¿‡æœŸæ—¶é—´ï¼Œå‘ç°è¶…è¿‡é€»è¾‘æ—¥æœŸæ—¶é—´åï¼Œä½¿ç”¨å•ç‹¬çš„çº¿ç¨‹æ„å»ºç¼“å­˜</p>
</li>
</ol>
<h2 id="13-5-ç¼“å­˜é›ªå´©"><a href="#13-5-ç¼“å­˜é›ªå´©" class="headerlink" title="13.5 ç¼“å­˜é›ªå´©"></a>13.5 ç¼“å­˜é›ªå´©</h2><p>ç¼“å­˜é›ªå´©ï¼Œæ˜¯æŒ‡åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µï¼Œç¼“å­˜é›†ä¸­è¿‡æœŸå¤±æ•ˆ</p>
<p>äº§ç”Ÿé›ªå´©çš„åŸå› ä¹‹ä¸€ï¼Œæ¯”å¦‚åœ¨å†™æœ¬æ–‡çš„æ—¶å€™ï¼Œé©¬ä¸Šå°±è¦åˆ°åŒåäºŒé›¶ç‚¹ï¼Œå¾ˆå¿«å°±ä¼šè¿æ¥ä¸€æ³¢æŠ¢è´­ï¼Œè¿™æ³¢å•†å“æ—¶é—´æ¯”è¾ƒé›†ä¸­çš„æ”¾å…¥äº†ç¼“å­˜ï¼Œå‡è®¾ç¼“å­˜ä¸€ä¸ªå°æ—¶ã€‚é‚£ä¹ˆåˆ°äº†å‡Œæ™¨ä¸€ç‚¹é’Ÿçš„æ—¶å€™ï¼Œè¿™æ‰¹å•†å“çš„ç¼“å­˜å°±éƒ½è¿‡æœŸäº†ã€‚è€Œå¯¹è¿™æ‰¹å•†å“çš„è®¿é—®æŸ¥è¯¢ï¼Œéƒ½è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå¯¹äºæ•°æ®åº“è€Œè¨€ï¼Œå°±ä¼šäº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›æ³¢å³°</p>
<p>å…¶å®é›†ä¸­è¿‡æœŸï¼Œå€’ä¸æ˜¯éå¸¸è‡´å‘½ï¼Œæ¯”è¾ƒè‡´å‘½çš„ç¼“å­˜é›ªå´©ï¼Œæ˜¯ç¼“å­˜æœåŠ¡å™¨æŸä¸ªèŠ‚ç‚¹å®•æœºæˆ–æ–­ç½‘</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>æ ¹æ®ä¸šåŠ¡çš„ä¸åŒï¼Œä¸ºä¸åŒçš„keyè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´</p>
<h1 id="14-rediså¼€å‘è§„èŒƒ"><a href="#14-rediså¼€å‘è§„èŒƒ" class="headerlink" title="14.rediså¼€å‘è§„èŒƒ"></a>14.rediså¼€å‘è§„èŒƒ</h1><h2 id="14-1-keyè®¾è®¡"><a href="#14-1-keyè®¾è®¡" class="headerlink" title="14.1 keyè®¾è®¡"></a>14.1 keyè®¾è®¡</h2><ul>
<li><p>å¯è¯»æ€§</p>
<p>ä»¥ä¸šåŠ¡åä¸ºå‰ç¼€(é˜²æ­¢keyå†²çª)ï¼Œç”¨å†’å·åˆ†å‰²ï¼Œæ¯”å¦‚ä¸šåŠ¡å:è¡¨å:idï¼Œå¦‚p2p:user:id</p>
</li>
<li><p>ç®€æ´æ€§</p>
<p>åœ¨ä¿è¯è¯­ä¹‰çš„æƒ…å†µä¸‹ï¼Œæ§åˆ¶keyçš„é•¿åº¦ï¼Œå½“keyè¾ƒå¤šæ—¶ï¼Œå†…å­˜å ç”¨ä¹Ÿä¸å®¹å¿½è§†ï¼Œå¦‚</p>
<p>user:{uid}:friends:messages:{mid}ç®€åŒ–ä¸ºu:{uid}:f:ms:{mid}</p>
</li>
<li><p>ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦</p>
<p>ä¸åŒ…å«ç©ºæ ¼ã€æ¢è¡Œã€å•åŒå¼•å·åŠå…¶ä»–è½¬ä¹‰ç¬¦</p>
</li>
</ul>
<p>keyçš„é•¿åº¦é€šå¸¸æ§åˆ¶åœ¨39ä¸ªå­—èŠ‚ä»¥å†…(redis3.x)</p>
<table>
<thead>
<tr>
<th>k-vä¸ªæ•°</th>
<th>39å­—èŠ‚</th>
<th>40å­—èŠ‚</th>
</tr>
</thead>
<tbody><tr>
<td>10ä¸‡</td>
<td>15.69M</td>
<td>18.75M</td>
</tr>
<tr>
<td>100ä¸‡</td>
<td>146.29M</td>
<td>176.81M</td>
</tr>
<tr>
<td>1000ä¸‡</td>
<td>1.47G</td>
<td>1.77G</td>
</tr>
<tr>
<td>1äº¿</td>
<td>14.6G</td>
<td>17.7G</td>
</tr>
</tbody></table>
<h2 id="14-2-valueè®¾è®¡"><a href="#14-2-valueè®¾è®¡" class="headerlink" title="14.2 valueè®¾è®¡"></a>14.2 valueè®¾è®¡</h2><p>è®¾è®¡å»ºè®®</p>
<ul>
<li>æ‹’ç»bigKey</li>
<li>é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„</li>
<li>è¿‡æœŸè®¾è®¡</li>
</ul>
<p><strong>æ‹’ç»bigKey</strong></p>
<p>ä¸æˆæ–‡çš„è§„å®š</p>
<ul>
<li>stringç±»å‹æ§åˆ¶åœ¨10kbä»¥å†…</li>
<li>hashã€listã€setã€zsetå…ƒç´ ä¸ªæ•°ä¸è¶…è¿‡5000</li>
</ul>
<p><strong>bigKeyçš„å½±å“</strong></p>
<ul>
<li>ç½‘ç»œé˜»å¡</li>
<li>redisé˜»å¡</li>
<li>é›†ç¾¤èŠ‚ç‚¹æ•°æ®å€¾æ–œ</li>
<li>é¢‘ç¹åºåˆ—åŒ–ï¼Œæ¶ˆè€—cpuèµ„æº</li>
</ul>
<p><strong>å‘ç°bigKey</strong></p>
<ul>
<li><p>åº”ç”¨å¼‚å¸¸</p>
<img src="http://ww1.sinaimg.cn/large/006tNc79gy1g4vvtvravsj31wi0p0q9w.jpg" width=7000 /></li>
<li><p>redis-cli â€“bigkeys</p>
</li>
<li><p>debug object</p>
</li>
<li><p>æµé‡ç›‘æ§æŠ¥è­¦</p>
</li>
</ul>
<p><strong>åˆ é™¤bigKey</strong></p>
<ul>
<li><p>éšæ€§åˆ é™¤</p>
<p>è®¾ç½®keyè¿‡æœŸ</p>
</li>
<li><p>lazy delete(redis 4.x)</p>
</li>
</ul>
<h2 id="14-3-å‘½åä¼˜åŒ–"><a href="#14-3-å‘½åä¼˜åŒ–" class="headerlink" title="14.3 å‘½åä¼˜åŒ–"></a>14.3 å‘½åä¼˜åŒ–</h2><ol>
<li>hgetallã€lrangeã€smembersã€zrangeã€sinteråœ¨æœ‰éå†éœ€æ±‚ä¸‹ï¼Œå¯ä½¿ç”¨hscanã€sscanã€zscanä»£æ›¿</li>
<li>ç¦ç”¨keysã€flushallã€flushdb</li>
<li>ä¸æ¨èä½¿ç”¨redisäº‹åŠ¡</li>
</ol>
<h1 id="15-å†…å­˜ä¼˜åŒ–"><a href="#15-å†…å­˜ä¼˜åŒ–" class="headerlink" title="15.å†…å­˜ä¼˜åŒ–"></a>15.å†…å­˜ä¼˜åŒ–</h1><h2 id="15-1-å†…å­˜ç®¡ç†"><a href="#15-1-å†…å­˜ç®¡ç†" class="headerlink" title="15.1 å†…å­˜ç®¡ç†"></a>15.1 å†…å­˜ç®¡ç†</h2><p><strong>å†…å­˜ä½¿ç”¨ç»Ÿè®¡</strong></p>
<p>ä½¿ç”¨info memoryå¯ä»¥æŸ¥çœ‹redis çš„å†…å­˜ä½¿ç”¨æƒ…å†µ</p>
<table>
<thead>
<tr>
<th>å±æ€§å</th>
<th>å±æ€§è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><font color=red>used_memory</font></td>
<td>rediså®é™…å­˜å‚¨æ•°æ®çš„å†…å­˜æ€»é‡</td>
</tr>
<tr>
<td>used_memory_human</td>
<td>ä»¥å¯è¯»æ ¼å¼è¿”å›redisä½¿ç”¨çš„å†…å­˜æ€»é‡</td>
</tr>
<tr>
<td><font color=red>used_memory_rss</font></td>
<td>ä»æ“ä½œç³»ç»Ÿè§’åº¦ï¼Œredisè¿›ç¨‹å ç”¨çš„æ€»ç‰©ç†å†…å­˜</td>
</tr>
<tr>
<td>used_memory_peak</td>
<td>åˆ†é…çš„æœ€å¤§å†…å­˜ï¼Œused_memoryå±æ€§çš„å†å²å³°å€¼</td>
</tr>
<tr>
<td>used_memory_peak_human</td>
<td>ä»¥å¯è¯»æ ¼å¼æ˜¾ç¤ºå†…å­˜æ¶ˆè€—å³°å€¼</td>
</tr>
<tr>
<td>used_memory_lua</td>
<td>Luaå¼•æ“æ¶ˆè€—çš„å†…å­˜</td>
</tr>
<tr>
<td><font color=red>mem_fragmentation_ratio</font></td>
<td>used_memory_rss/used_memoryæ¯”å€¼ï¼Œè¡¨ç¤ºå†…å­˜ç¢ç‰‡ç‡</td>
</tr>
<tr>
<td>mem_allocator</td>
<td>redisæ‰€ä½¿ç”¨çš„å†…å­˜åˆ†é…å™¨ï¼Œé»˜è®¤ï¼šjemalloc</td>
</tr>
</tbody></table>
</div><div class="tags"><a href="/tags/Redis/"><i class="fa fa-tag"></i>Redis</a></div><div class="post-nav"><a class="pre" href="/2020/06/09/jconsole%E7%9A%84%E9%85%8D%E7%BD%AE/">jconsoleé…ç½®</a><a class="next" href="/2020/03/20/Redis%E5%9F%BA%E7%A1%80(%E4%BA%8C)/">RedisåŸºç¡€(äºŒ)</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/FastDFS/">FastDFS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA-%E9%A1%B9%E7%9B%AE/">JAVA-é¡¹ç›®</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA%E5%9F%BA%E7%A1%80/">JAVAåŸºç¡€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kafaka/">Kafaka</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Maven/">Maven</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MyBatis/">MyBatis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Scala/">Scala</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spark/">Spark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot/">Spring Boot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringMVC/">SpringMVC</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kafuka/">kafuka</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/">ç‰ˆæœ¬æ§åˆ¶å·¥å…·</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">è®¡ç®—æœºç½‘ç»œ</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/JAVA/" style="font-size: 15px;">JAVA</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/FastDFS/" style="font-size: 15px;">FastDFS</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/JAVA-WEB/" style="font-size: 15px;">JAVA-WEB</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/SVN/" style="font-size: 15px;">SVN</a> <a href="/tags/kafuka/" style="font-size: 15px;">kafuka</a> <a href="/tags/linux%E5%91%BD%E4%BB%A4/" style="font-size: 15px;">linuxå‘½ä»¤</a> <a href="/tags/Maven/" style="font-size: 15px;">Maven</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/yum%E5%91%BD%E4%BB%A4/" style="font-size: 15px;">yumå‘½ä»¤</a> <a href="/tags/SSL/" style="font-size: 15px;">SSL</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/Scala/" style="font-size: 15px;">Scala</a> <a href="/tags/Spark/" style="font-size: 15px;">Spark</a> <a href="/tags/Spring-Boot/" style="font-size: 15px;">Spring Boot</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 15px;">é¡¹ç›®</a> <a href="/tags/SpringMVC/" style="font-size: 15px;">SpringMVC</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/%E5%BF%83%E6%83%85/" style="font-size: 15px;">å¿ƒæƒ…</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2050/08/09/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8F%90%E4%BA%A4/">ğŸ‘‹ Hi!</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/30/maven%E7%9A%84pom%E9%85%8D%E7%BD%AE/">Mavençš„pomé…ç½®</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/12/kafuka%E6%93%8D%E4%BD%9C/">kafukaæ“ä½œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/12/CUP%E5%8D%A0%E7%94%A8%E7%8E%87%E8%BF%87%E9%AB%98%E5%AE%9A%E4%BD%8D%E8%BF%87%E7%A8%8B/">å®šä½cupå ç”¨è¿‡é«˜</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/11/Git/">Git</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/11/Docker/">Docker</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/11/Kafka/">Kafakaæ­å»º</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/11/Spring/">Spring</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/09/%E6%B7%BB%E5%8A%A0CA%E8%AF%81%E4%B9%A6/">æ·»åŠ CAè¯ä¹¦æ‰§è¡Œæ­¥éª¤</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/10/linux%E6%9F%A5%E7%9C%8B%E5%B7%B2%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E4%B8%8E%E5%8D%B8%E8%BD%BD/">linuxæŸ¥çœ‹å·²å®‰è£…è½¯ä»¶ä¸å¸è½½</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2021 <a href="/." rel="nofollow">äº‘èµ·è¿é£ç‡•.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>